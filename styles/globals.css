/* frontend/styles/globals.css
   Responsive global styles for the chat project.
   Mobile-first approach. */

/* --- Reset & base --- */
:root{
  --bg: #ffffff;
  --muted: #666666;
  --line: #e9e9e9;
  --bubble: #f7f7f7;
  --bubble-me: #f0f0f0;
  --accent: #111111;
  --max-width: 1100px;
  --sidebar-w: 300px;
  --sidebar-w-collapsed: 0;
  --gap: 12px;
  --radius: 8px;
  --nav-h: 56px;
  --composer-h: 64px;
}

*{box-sizing:border-box}
html,body,#__next{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:#f6f6f6;color:var(--accent)}
a{color:inherit;text-decoration:none}
button { font-family: inherit }

/* utility */
.container { max-width: var(--max-width); margin: 0 auto; padding: 0 12px; }

/* --- App layout --- */
.app-root { display:flex; height:100vh; width:100%; min-width:320px; }

/* sidebar */
.sidebar {
  width: var(--sidebar-w);
  background: var(--bg);
  border-right: 1px solid var(--line);
  display:flex;
  flex-direction:column;
  padding: 12px;
  gap: 10px;
  transition: transform .22s ease, width .22s ease;
}

.sidebar .brand { font-weight:700; font-size:18px; color:var(--accent) }
.sidebar .logged-as { font-size:13px; color:var(--muted); margin-top:4px }

/* search */
.search-bar {
  width:100%;
  padding:10px;
  border-radius:var(--radius);
  border:1px solid var(--line);
  background:#fafafa;
}

/* lists inside sidebar scroll */
.sidebar .scroll {
  overflow-y:auto;
  flex:1;
  padding-right:6px;
}

/* conversation item */
.conv-item {
  display:flex; gap:10px; align-items:center; padding:8px; border-radius:8px; cursor:pointer;
}
.conv-item.active { background:#fbfbfb }
.conv-item:hover { background:#fafafa }
.conv-item .avatar { width:40px; height:40px; border-radius:8px; background:#e9e9e9; display:flex; align-items:center; justify-content:center; font-weight:700; color:#444; flex-shrink:0 }

/* main area */
.main {
  flex:1; display:flex; flex-direction:column; background:var(--bg); height:100%;
}

/* header */
.chat-header {
  height: var(--nav-h);
  display:flex; align-items:center; gap:12px;
  padding: 0 14px; border-bottom:1px solid var(--line); background:var(--bg);
}
.chat-header .logged-user { display:flex; align-items:center; gap:8px; margin-left:auto; }

/* messages area scrolls only */
.messages {
  flex:1;
  overflow-y:auto;
  padding: 16px;
  display:flex; flex-direction:column; gap:10px;
  background: #fff;
}

/* message */
.msg-row { display:flex; gap:10px; align-items:flex-start; max-width:100%; }
.msg-row.mine { flex-direction:row-reverse; }
.msg-avatar { width:40px; height:40px; border-radius:8px; background:#e9e9e9; display:flex; align-items:center; justify-content:center; font-weight:700; color:#444; flex-shrink:0 }
.msg-body { max-width:75%; display:flex; flex-direction:column; gap:6px; }
.msg-author { font-weight:600; font-size:13px; color:var(--accent) }
.msg-bubble { padding:10px 12px; border-radius:10px; background:var(--bubble); border:1px solid #eee; color:var(--accent); word-break:break-word; }
.msg-row.mine .msg-bubble { background:var(--bubble-me) }

/* composer */
.composer { height: var(--composer-h); display:flex; gap:8px; align-items:center; padding:10px 14px; border-top:1px solid var(--line); background:var(--bg) }
.composer input { flex:1; padding:10px; border-radius:8px; border:1px solid var(--line); background:#fff }
.composer button { padding:10px 14px; border-radius:8px; background:var(--accent); color:#fff; border:none; cursor:pointer }

/* small devices: collapse sidebar into drawer, show hamburger in header */
.header-hamburger{ display:none; border:0; background:transparent; font-size:20px; cursor:pointer; }
@media (max-width: 860px) {
  .app-root { flex-direction:column; }
  .sidebar { position:fixed; top:0; left:0; height:100vh; z-index:80; width:var(--sidebar-w); transform: translateX(-100%); box-shadow: 2px 0 12px rgba(0,0,0,0.06); }
  .sidebar.open { transform: translateX(0); }
  .main { margin-left:0; width:100%; height:100vh; }
  .chat-header { padding: 0 10px; }
  .header-hamburger { display:inline-block; margin-right:6px; }
  .messages { padding: 12px; }
  .composer { position:fixed; bottom:0; left:0; right:0; z-index:10; box-shadow: 0 -2px 6px rgba(0,0,0,0.03) }
  .sidebar .scroll { -webkit-overflow-scrolling: touch; }
  /* when sidebar is not open hide overflow on body via class toggled by JS if you desire */
}

/* very small screens */
@media (max-width: 420px) {
  :root { --sidebar-w: 260px; --nav-h: 52px; --composer-h: 60px }
  .msg-body { max-width:86% }
  .msg-avatar{ width:36px; height:36px }
  .conv-item .avatar { width:36px; height:36px }
  .composer input{ padding:8px }
}

/* profile / login / signup responsive helpers */
/* containers */
.form-card { width:100%; max-width:420px; margin: 36px auto; background:#fff; padding:18px; border-radius:12px; box-shadow:0 4px 14px rgba(0,0,0,0.04) }
.form-row { display:flex; flex-direction:column; gap:10px; }
.form-row input, .form-row button { padding:10px; border-radius:8px; border:1px solid var(--line) }

/* responsive grid small screens stack */
@media (max-width:860px){
  .form-card{ margin: 20px; padding:14px; }
}

/* utility for minor text */
.muted { color:var(--muted); font-size:13px; }

/* small scrollbar tweak: only visible when scrolling */
.messages::-webkit-scrollbar, .sidebar .scroll::-webkit-scrollbar { width:8px }
.messages::-webkit-scrollbar-thumb, .sidebar .scroll::-webkit-scrollbar-thumb { background:rgba(0,0,0,0.08); border-radius:999px }

/* end */
/* --- Mobile message display fixes --- */

/* Make rows align to top so tall/wrapped messages don't push avatar down */
.msg-row,
.message {
  align-items: flex-start !important; /* ensure top alignment */
}

/* Make avatar align to the top of the message bubble */
.msg-avatar,
.msg-avatar img,
.msg-left .avatar {
  align-self: flex-start;
}

/* Ensure bubbles wrap cleanly and do not create vertical misalignment */
.msg-bubble,
.message-content {
  word-break: break-word;
  white-space: pre-wrap; /* keep user line breaks but wrap long words */
  display: inline-block;
  max-width: 100%;
  box-sizing: border-box;
}

/* Limit bubble width on small screens so they don't push off layout */
@media (max-width: 860px) {
  .msg-body { max-width: 86% !important; }
  .msg-bubble, .message-content { max-width: 86vw; } /* fit within viewport */
}

/* --- Prevent last message being hidden by composer on mobile ---
   If composer is fixed on small screens, give messages container bottom padding
   equal to composer height + a bit of breathing room.
*/
@media (max-width: 860px) {
  :root { --composer-h: 64px; } /* if you used a different value, adjust */
  .messages {
    padding-bottom: calc(var(--composer-h) + 20px) !important;
    -webkit-overflow-scrolling: touch;
  }

  /* Ensure the last message is visible when scrolled into view */
  .messages > *:last-child {
    margin-bottom: calc(var(--composer-h) + 6px);
  }
}

/* Optional: make sure 'mine' messages align bubble to right but top-aligned */
.msg-row.mine .msg-bubble,
.message.me .message-content {
  align-self: flex-start; /* bubble still top-aligned; container uses row-reverse */
}
